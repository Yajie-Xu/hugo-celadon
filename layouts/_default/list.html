{{ define "main" }}
  <section class="listing-shell">
    <div class="listing-header">
      <p class="article-date">{{ .Date.Format "Jan 2, 2006" }}</p>
      <h1 class="article-title">{{ .Title }}</h1>
      {{ with .Params.description }}
        <p class="summary">{{ . }}</p>
      {{ end }}
    </div>
    <div class="listing-toolbar" role="group" aria-label="Choose layout">
      <button type="button" class="view-btn" data-view="view-card" aria-label="Card view">
        <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.8" stroke-linecap="round" stroke-linejoin="round">
          <rect x="3" y="3" width="7" height="7"></rect>
          <rect x="14" y="3" width="7" height="7"></rect>
          <rect x="3" y="14" width="7" height="7"></rect>
          <rect x="14" y="14" width="7" height="7"></rect>
        </svg>
      </button>
      <button type="button" class="view-btn" data-view="view-list" aria-label="List view">
        <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.8" stroke-linecap="round" stroke-linejoin="round">
          <line x1="8" y1="6" x2="21" y2="6"></line>
          <line x1="8" y1="12" x2="21" y2="12"></line>
          <line x1="8" y1="18" x2="21" y2="18"></line>
          <circle cx="4" cy="6" r="1"></circle>
          <circle cx="4" cy="12" r="1"></circle>
          <circle cx="4" cy="18" r="1"></circle>
        </svg>
      </button>
      <button type="button" class="view-btn" data-view="view-compact" aria-label="Compact view">
        <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.8" stroke-linecap="round" stroke-linejoin="round">
          <rect x="3" y="4" width="5" height="5"></rect>
          <rect x="10" y="4" width="5" height="5"></rect>
          <rect x="17" y="4" width="4" height="5"></rect>
          <rect x="3" y="11" width="4" height="5"></rect>
          <rect x="9" y="11" width="4" height="5"></rect>
          <rect x="15" y="11" width="6" height="5"></rect>
        </svg>
      </button>
    </div>
    {{ $pages := .Pages.ByDate.Reverse }}
    <div id="listing-container" class="listing-grid view-card">
      {{ range $pages }}
        {{ $thumb := or .Params.thumbnail .Params.image "/images/profile.jpg" }}
        <article class="listing-card">
          <div class="listing-thumb">
            <img src="{{ $thumb | relURL }}" alt="">
          </div>
          <div class="listing-date">{{ .Date.Format "Jan 2, 2006" }}</div>
          <h3>{{ .Title }}</h3>
          {{ with .Params.summary }}
            <p>{{ . }}</p>
          {{ end }}
          <a href="{{ .RelPermalink }}">Read â†’</a>
        </article>
      {{ end }}
    </div>
  </section>
  <script>
    (function () {
      const container = document.getElementById("listing-container");
      if (!container) return;
      const buttons = document.querySelectorAll(".view-btn");
      const key = "listing-view-mode";
      const apply = (mode) => {
        container.classList.remove("view-card", "view-list", "view-compact");
        container.classList.add(mode);
        buttons.forEach((btn) =>
          btn.classList.toggle("active", btn.dataset.view === mode)
        );
      };
      const stored = localStorage.getItem(key) || "view-card";
      apply(stored);
      buttons.forEach((btn) =>
        btn.addEventListener("click", () => {
          const mode = btn.dataset.view;
          apply(mode);
          localStorage.setItem(key, mode);
        })
      );
    })();
  </script>
{{ end }}
